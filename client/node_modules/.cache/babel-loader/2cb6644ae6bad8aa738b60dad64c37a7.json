{"ast":null,"code":"import _asyncToGenerator from\"/home/tom/Desktop/product-feedback-app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/home/tom/Desktop/product-feedback-app/client/node_modules/@babel/runtime/regenerator/index.js\";import{FETCH_FILTERED,FETCH_SUGGESTION,CREATE_SUGGESTION,UPDATE_SUGGESTION,DELETE_SUGGESTION,DELETE_COMMENT,UPVOTE,COMMENT,REPLY,START_LOADING,END_LOADING,CHANGE_FILTERS}from\"../constants/actionTypes\";import*as api from\"../api\";// The following code is used to generate a username for users signed in with GoogleOAuth.\nvar generateGoogleUsername=function generateGoogleUsername(user){return(user===null||user===void 0?void 0:user.result.name.split(\" \").join(\"\").toLowerCase())+String(user===null||user===void 0?void 0:user.result.googleId).slice(0,3);};// Action Creators - Must use redux thunk since we are working with asynchronous data\nexport var getSuggestion=function getSuggestion(id){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var _yield$api$fetchSugge,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;dispatch({type:START_LOADING});_context.next=4;return api.fetchSuggestion(id);case 4:_yield$api$fetchSugge=_context.sent;data=_yield$api$fetchSugge.data;dispatch({type:FETCH_SUGGESTION,payload:{suggestion:data}});dispatch({type:END_LOADING});_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.log(_context.t0.message);case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var createSuggestion=function createSuggestion(newSuggestion){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var _yield$api$createSugg,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;dispatch({type:START_LOADING});_context2.next=4;return api.createSuggestion(newSuggestion);case 4:_yield$api$createSugg=_context2.sent;data=_yield$api$createSugg.data;dispatch({type:CREATE_SUGGESTION,payload:data});dispatch({type:END_LOADING});_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0.message);case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[0,10]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var updateSuggestion=function updateSuggestion(id,formData){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var _yield$api$updateSugg,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;dispatch({type:START_LOADING});_context3.next=4;return api.updateSuggestion(id,formData);case 4:_yield$api$updateSugg=_context3.sent;data=_yield$api$updateSugg.data;dispatch({type:UPDATE_SUGGESTION,payload:data});dispatch({type:END_LOADING});_context3.next=13;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0.message);case 13:case\"end\":return _context3.stop();}}},_callee3,null,[[0,10]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var deleteSuggestion=function deleteSuggestion(id){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;dispatch({type:START_LOADING});_context4.next=4;return api.deleteSuggestion(id);case 4:dispatch({type:DELETE_SUGGESTION,payload:id});dispatch({type:END_LOADING});_context4.next=11;break;case 8:_context4.prev=8;_context4.t0=_context4[\"catch\"](0);console.log(_context4.t0.message);case 11:case\"end\":return _context4.stop();}}},_callee4,null,[[0,8]]);}));return function(_x4){return _ref4.apply(this,arguments);};}();};// Returns suggestions that meet filter criteria (category, type, and order)\n// Category - All, UI, UX, Enhancement, Bug, Feature\n// Type - Upvotes or Comments\n// Order - Ascending (Least) or Descending (Most)\nexport var filterSuggestions=function filterSuggestions(_ref5){var category=_ref5.category,type=_ref5.type,order=_ref5.order;return/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch){var _yield$api$fetchFilte,data,planned,inProgress,live,roadmap,suggestionData;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;dispatch({type:START_LOADING});_context5.next=4;return api.fetchFilteredSuggestions(category,type,order);case 4:_yield$api$fetchFilte=_context5.sent;data=_yield$api$fetchFilte.data;// Retrieve the filtered suggestions based on status for the roadmap\nplanned=data.filter(function(suggestion){return suggestion.status===\"planned\";});inProgress=data.filter(function(suggestion){return suggestion.status===\"in-progress\";});live=data.filter(function(suggestion){return suggestion.status===\"live\";});roadmap={planned:planned,\"in-progress\":inProgress,live:live};// Payload containing all sorted suggestions as well as suggestions\n// that are in the roadmap\nsuggestionData={data:data,roadmap:roadmap};dispatch({type:FETCH_FILTERED,payload:suggestionData});dispatch({type:END_LOADING});_context5.next=18;break;case 15:_context5.prev=15;_context5.t0=_context5[\"catch\"](0);console.log(_context5.t0.message);case 18:case\"end\":return _context5.stop();}}},_callee5,null,[[0,15]]);}));return function(_x5){return _ref6.apply(this,arguments);};}();};// Updates the filters currently selected by the user. This allows for\n// the search to work synchronously despite being in two seperate components.\n// Category component - SuggestionTag.js\n// Upvotes and Comments sort component - SuggestionsBar.js\nexport var setFilters=function setFilters(filters){return/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(dispatch){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:dispatch({type:CHANGE_FILTERS,payload:filters});case 1:case\"end\":return _context6.stop();}}},_callee6);}));return function(_x6){return _ref7.apply(this,arguments);};}();};export var upvoteSuggestion=function upvoteSuggestion(id){return/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(dispatch){var _yield$api$upvoteSugg,data;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.prev=0;_context7.next=3;return api.upvoteSuggestion(id);case 3:_yield$api$upvoteSugg=_context7.sent;data=_yield$api$upvoteSugg.data;dispatch({type:UPVOTE,payload:data});_context7.next=11;break;case 8:_context7.prev=8;_context7.t0=_context7[\"catch\"](0);console.log(_context7.t0.message);case 11:case\"end\":return _context7.stop();}}},_callee7,null,[[0,8]]);}));return function(_x7){return _ref8.apply(this,arguments);};}();};export var commentSuggestion=function commentSuggestion(comment,id){return/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(dispatch){var _user$result;var user,username,userId,commentData,_yield$api$commentSug,data;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:user=JSON.parse(localStorage.getItem(\"profile\"));username=(user===null||user===void 0?void 0:user.result.username)||generateGoogleUsername(user);userId=(user===null||user===void 0?void 0:user.result._id)||(user===null||user===void 0?void 0:user.result.googleId);commentData={content:comment,user:{id:userId,name:user===null||user===void 0?void 0:(_user$result=user.result)===null||_user$result===void 0?void 0:_user$result.name,// Add full name to comment data\nusername:username// Add username to comment data\n}};_context8.prev=4;_context8.next=7;return api.commentSuggestion(commentData,id);case 7:_yield$api$commentSug=_context8.sent;data=_yield$api$commentSug.data;dispatch({type:COMMENT,payload:data});return _context8.abrupt(\"return\",data.comments);case 13:_context8.prev=13;_context8.t0=_context8[\"catch\"](4);console.log(_context8.t0.message);case 16:case\"end\":return _context8.stop();}}},_callee8,null,[[4,13]]);}));return function(_x8){return _ref9.apply(this,arguments);};}();};export var replyToComment=function replyToComment(comment,replyUser,id,parentCommentId){return/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(dispatch){var _user$result2;var user,username,userId,replyData,_yield$api$replyToCom,data;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:user=JSON.parse(localStorage.getItem(\"profile\"));username=(user===null||user===void 0?void 0:user.result.username)||generateGoogleUsername(user);userId=(user===null||user===void 0?void 0:user.result.id)||(user===null||user===void 0?void 0:user.result.googleId);replyData={content:comment,replyingTo:replyUser,user:{id:userId,name:user===null||user===void 0?void 0:(_user$result2=user.result)===null||_user$result2===void 0?void 0:_user$result2.name,// Add full name to comment data\nusername:username// Add username to comment data\n}};_context9.prev=4;_context9.next=7;return api.replyToComment(replyData,id,parentCommentId);case 7:_yield$api$replyToCom=_context9.sent;data=_yield$api$replyToCom.data;dispatch({type:REPLY,payload:data});return _context9.abrupt(\"return\",data.comments.find(function(comment){return comment._id===parentCommentId;}).replies);case 13:_context9.prev=13;_context9.t0=_context9[\"catch\"](4);console.log(_context9.t0.message);case 16:case\"end\":return _context9.stop();}}},_callee9,null,[[4,13]]);}));return function(_x9){return _ref10.apply(this,arguments);};}();};export var deleteComment=function deleteComment(suggestionId,commentId){return/*#__PURE__*/function(){var _ref11=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(dispatch){var _yield$api$deleteComm,data;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.prev=0;_context10.next=3;return api.deleteComment(suggestionId,commentId);case 3:_yield$api$deleteComm=_context10.sent;data=_yield$api$deleteComm.data;dispatch({type:DELETE_COMMENT,payload:data});return _context10.abrupt(\"return\",data);case 9:_context10.prev=9;_context10.t0=_context10[\"catch\"](0);console.log(_context10.t0.message);case 12:case\"end\":return _context10.stop();}}},_callee10,null,[[0,9]]);}));return function(_x10){return _ref11.apply(this,arguments);};}();};","map":{"version":3,"sources":["/home/tom/Desktop/product-feedback-app/client/src/actions/suggestions.js"],"names":["FETCH_FILTERED","FETCH_SUGGESTION","CREATE_SUGGESTION","UPDATE_SUGGESTION","DELETE_SUGGESTION","DELETE_COMMENT","UPVOTE","COMMENT","REPLY","START_LOADING","END_LOADING","CHANGE_FILTERS","api","generateGoogleUsername","user","result","name","split","join","toLowerCase","String","googleId","slice","getSuggestion","id","dispatch","type","fetchSuggestion","data","payload","suggestion","console","log","message","createSuggestion","newSuggestion","updateSuggestion","formData","deleteSuggestion","filterSuggestions","category","order","fetchFilteredSuggestions","planned","filter","status","inProgress","live","roadmap","suggestionData","setFilters","filters","upvoteSuggestion","commentSuggestion","comment","JSON","parse","localStorage","getItem","username","userId","_id","commentData","content","comments","replyToComment","replyUser","parentCommentId","replyData","replyingTo","find","replies","deleteComment","suggestionId","commentId"],"mappings":"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","sourcesContent":["import {\n  FETCH_FILTERED,\n  FETCH_SUGGESTION,\n  CREATE_SUGGESTION,\n  UPDATE_SUGGESTION,\n  DELETE_SUGGESTION,\n  DELETE_COMMENT,\n  UPVOTE,\n  COMMENT,\n  REPLY,\n  START_LOADING,\n  END_LOADING,\n  CHANGE_FILTERS,\n} from \"../constants/actionTypes\";\nimport * as api from \"../api\";\n\n// The following code is used to generate a username for users signed in with GoogleOAuth.\nconst generateGoogleUsername = (user) => {\n  return (\n    user?.result.name.split(\" \").join(\"\").toLowerCase() +\n    String(user?.result.googleId).slice(0, 3)\n  );\n};\n\n// Action Creators - Must use redux thunk since we are working with asynchronous data\n\nexport const getSuggestion = (id) => async (dispatch) => {\n  try {\n    dispatch({ type: START_LOADING });\n    const { data } = await api.fetchSuggestion(id);\n\n    dispatch({ type: FETCH_SUGGESTION, payload: { suggestion: data } });\n    dispatch({ type: END_LOADING });\n  } catch (error) {\n    console.log(error.message);\n  }\n};\n\nexport const createSuggestion = (newSuggestion) => async (dispatch) => {\n  try {\n    dispatch({ type: START_LOADING });\n    const { data } = await api.createSuggestion(newSuggestion);\n    dispatch({ type: CREATE_SUGGESTION, payload: data });\n    dispatch({ type: END_LOADING });\n  } catch (error) {\n    console.log(error.message);\n  }\n};\n\nexport const updateSuggestion = (id, formData) => async (dispatch) => {\n  try {\n    dispatch({ type: START_LOADING });\n    const { data } = await api.updateSuggestion(id, formData);\n    dispatch({ type: UPDATE_SUGGESTION, payload: data });\n    dispatch({ type: END_LOADING });\n  } catch (error) {\n    console.log(error.message);\n  }\n};\n\nexport const deleteSuggestion = (id) => async (dispatch) => {\n  try {\n    dispatch({ type: START_LOADING });\n    await api.deleteSuggestion(id);\n    dispatch({ type: DELETE_SUGGESTION, payload: id });\n    dispatch({ type: END_LOADING });\n  } catch (error) {\n    console.log(error.message);\n  }\n};\n\n// Returns suggestions that meet filter criteria (category, type, and order)\n// Category - All, UI, UX, Enhancement, Bug, Feature\n// Type - Upvotes or Comments\n// Order - Ascending (Least) or Descending (Most)\nexport const filterSuggestions =\n  ({ category, type, order }) =>\n  async (dispatch) => {\n    try {\n      dispatch({ type: START_LOADING });\n\n      const { data } = await api.fetchFilteredSuggestions(\n        category,\n        type,\n        order\n      );\n\n      // Retrieve the filtered suggestions based on status for the roadmap\n      const planned = data.filter(\n        (suggestion) => suggestion.status === \"planned\"\n      );\n      const inProgress = data.filter(\n        (suggestion) => suggestion.status === \"in-progress\"\n      );\n      const live = data.filter((suggestion) => suggestion.status === \"live\");\n\n      const roadmap = {\n        planned: planned,\n        \"in-progress\": inProgress,\n        live: live,\n      };\n\n      // Payload containing all sorted suggestions as well as suggestions\n      // that are in the roadmap\n      let suggestionData = { data, roadmap };\n\n      dispatch({ type: FETCH_FILTERED, payload: suggestionData });\n      dispatch({ type: END_LOADING });\n    } catch (error) {\n      console.log(error.message);\n    }\n  };\n\n// Updates the filters currently selected by the user. This allows for\n// the search to work synchronously despite being in two seperate components.\n// Category component - SuggestionTag.js\n// Upvotes and Comments sort component - SuggestionsBar.js\nexport const setFilters = (filters) => async (dispatch) => {\n  dispatch({ type: CHANGE_FILTERS, payload: filters });\n};\n\nexport const upvoteSuggestion = (id) => async (dispatch) => {\n  try {\n    const { data } = await api.upvoteSuggestion(id);\n    dispatch({ type: UPVOTE, payload: data });\n  } catch (error) {\n    console.log(error.message);\n  }\n};\n\nexport const commentSuggestion = (comment, id) => async (dispatch) => {\n  const user = JSON.parse(localStorage.getItem(\"profile\"));\n  const username = user?.result.username || generateGoogleUsername(user);\n  const userId = user?.result._id || user?.result.googleId;\n\n  const commentData = {\n    content: comment,\n    user: {\n      id: userId,\n      name: user?.result?.name, // Add full name to comment data\n      username: username, // Add username to comment data\n    },\n  };\n\n  try {\n    const { data } = await api.commentSuggestion(commentData, id);\n    dispatch({ type: COMMENT, payload: data });\n    return data.comments; // Return all the comments on the suggestion to reflect comment changes on the front end\n  } catch (error) {\n    console.log(error.message);\n  }\n};\n\nexport const replyToComment =\n  (comment, replyUser, id, parentCommentId) => async (dispatch) => {\n    const user = JSON.parse(localStorage.getItem(\"profile\"));\n    const username = user?.result.username || generateGoogleUsername(user);\n    const userId = user?.result.id || user?.result.googleId;\n    const replyData = {\n      content: comment,\n      replyingTo: replyUser,\n      user: {\n        id: userId,\n        name: user?.result?.name, // Add full name to comment data\n        username: username, // Add username to comment data\n      },\n    };\n    try {\n      const { data } = await api.replyToComment(replyData, id, parentCommentId);\n      dispatch({ type: REPLY, payload: data });\n      return data.comments.find((comment) => comment._id === parentCommentId)\n        .replies;\n    } catch (error) {\n      console.log(error.message);\n    }\n  };\n\nexport const deleteComment = (suggestionId, commentId) => async (dispatch) => {\n  try {\n    const { data } = await api.deleteComment(suggestionId, commentId);\n    dispatch({ type: DELETE_COMMENT, payload: data });\n    return data;\n  } catch (error) {\n    console.log(error.message);\n  }\n};\n"]},"metadata":{},"sourceType":"module"}