{"ast":null,"code":"import _asyncToGenerator from\"/home/tom/Desktop/product-feedback-app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/tom/Desktop/product-feedback-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/home/tom/Desktop/product-feedback-app/client/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState}from\"react\";import styles from\"../Comments/Comments.module.css\";import{useDispatch}from\"react-redux\";import{useParams,Link}from\"react-router-dom\";import{commentSuggestion}from\"../../../actions/suggestions\";import Button from\"../../UI/Button/Button\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var AddCommentForm=function AddCommentForm(_ref){var currentUser=_ref.currentUser,updateComments=_ref.updateComments;var _useState=useState(225),_useState2=_slicedToArray(_useState,2),charsLeft=_useState2[0],setCharsLeft=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),comment=_useState4[0],setComment=_useState4[1];var dispatch=useDispatch();var isValid=charsLeft>0;var _useParams=useParams(),id=_useParams.id;var user=JSON.parse(localStorage.getItem(\"profile\"));var handleAddComment=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var _currentUser$result,_currentUser$result2;var newComments;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_context.next=3;return dispatch(commentSuggestion({content:comment,user:{name:currentUser===null||currentUser===void 0?void 0:(_currentUser$result=currentUser.result)===null||_currentUser$result===void 0?void 0:_currentUser$result.name,// Add full name to comment data\nusername:currentUser===null||currentUser===void 0?void 0:(_currentUser$result2=currentUser.result)===null||_currentUser$result2===void 0?void 0:_currentUser$result2.username// Add username to comment data\n}},id));case 3:newComments=_context.sent;setComment(\"\");// Reset the comment\nupdateComments(newComments);// Refresh the comments to reflect the newly added comment\ncase 6:case\"end\":return _context.stop();}}},_callee);}));return function handleAddComment(_x){return _ref2.apply(this,arguments);};}();// Update comment field character count and the comment to be posted by the user.\nvar handleCommentChange=function handleCommentChange(e){setCharsLeft(225-e.target.value.length);setComment(e.target.value);};return/*#__PURE__*/_jsxs(\"form\",{id:\"add-comment\",className:styles.comments,children:[!user&&/*#__PURE__*/_jsxs(\"h2\",{className:styles[\"comments_header\"],children:[/*#__PURE__*/_jsx(Link,{to:\"/auth\",children:\"Login\"}),\" to add a comment\"]}),user&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{className:styles[\"comments_header\"],children:\"Add a comment\"}),/*#__PURE__*/_jsx(\"textarea\",{className:styles[\"comment_textarea\"],onChange:handleCommentChange,value:comment,placeholder:\"Type your comment here...\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles[\"comment_details\"],children:[/*#__PURE__*/_jsxs(\"p\",{className:\"\".concat(styles[\"comment_charcount\"],\" \").concat(!isValid&&styles[\"comment_charcount--error\"]),children:[charsLeft,\" characters left\"]}),/*#__PURE__*/_jsx(Button,{btnStyle:isValid?\"violet\":\"disabled\",text:\"Post Comment\",form:\"add-comment\",\"aria-disabled\":!isValid,onClick:handleAddComment})]})]})]});};export default AddCommentForm;","map":{"version":3,"sources":["/home/tom/Desktop/product-feedback-app/client/src/components/SuggestionPage/AddCommentForm/AddCommentForm.js"],"names":["React","useState","styles","useDispatch","useParams","Link","commentSuggestion","Button","AddCommentForm","currentUser","updateComments","charsLeft","setCharsLeft","comment","setComment","dispatch","isValid","id","user","JSON","parse","localStorage","getItem","handleAddComment","e","preventDefault","content","name","result","username","newComments","handleCommentChange","target","value","length","comments"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport styles from \"../Comments/Comments.module.css\";\nimport { useDispatch } from \"react-redux\";\nimport { useParams, Link } from \"react-router-dom\";\nimport { commentSuggestion } from \"../../../actions/suggestions\";\nimport Button from \"../../UI/Button/Button\";\nconst AddCommentForm = ({ currentUser, updateComments }) => {\n  const [charsLeft, setCharsLeft] = useState(225);\n  const [comment, setComment] = useState(\"\");\n  const dispatch = useDispatch();\n  const isValid = charsLeft > 0;\n  const { id } = useParams();\n\n  const user = JSON.parse(localStorage.getItem(\"profile\"));\n\n  const handleAddComment = async (e) => {\n    e.preventDefault();\n\n    const newComments = await dispatch(\n      commentSuggestion(\n        {\n          content: comment,\n          user: {\n            name: currentUser?.result?.name, // Add full name to comment data\n            username: currentUser?.result?.username, // Add username to comment data\n          },\n        },\n        id\n      )\n    );\n\n    setComment(\"\"); // Reset the comment\n    updateComments(newComments); // Refresh the comments to reflect the newly added comment\n  };\n\n  // Update comment field character count and the comment to be posted by the user.\n  const handleCommentChange = (e) => {\n    setCharsLeft(225 - e.target.value.length);\n    setComment(e.target.value);\n  };\n\n  return (\n    <form id=\"add-comment\" className={styles.comments}>\n      {!user && (\n        <h2 className={styles[\"comments_header\"]}>\n          <Link to=\"/auth\">Login</Link> to add a comment\n        </h2>\n      )}\n      {user && (\n        <>\n          <h2 className={styles[\"comments_header\"]}>Add a comment</h2>\n          <textarea\n            className={styles[\"comment_textarea\"]}\n            onChange={handleCommentChange}\n            value={comment}\n            placeholder=\"Type your comment here...\"\n          />\n          <div className={styles[\"comment_details\"]}>\n            <p\n              className={`${styles[\"comment_charcount\"]} ${\n                !isValid && styles[\"comment_charcount--error\"]\n              }`}\n            >\n              {charsLeft} characters left\n            </p>\n            <Button\n              btnStyle={isValid ? \"violet\" : \"disabled\"}\n              text=\"Post Comment\"\n              form=\"add-comment\"\n              aria-disabled={!isValid}\n              onClick={handleAddComment}\n            />\n          </div>\n        </>\n      )}\n    </form>\n  );\n};\n\nexport default AddCommentForm;\n"]},"metadata":{},"sourceType":"module"}